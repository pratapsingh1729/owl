<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Owl_nlp_corpus (owl.Owl_nlp_corpus)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">owl</a> &#x00BB; Owl_nlp_corpus</nav><h1>Module <code>Owl_nlp_corpus</code></h1><p>NLP: Corpus module</p><nav class="toc"><ul><li><a href="#type-definition">Type definition</a></li><li><a href="#query-corpus">Query corpus</a></li><li><a href="#iteration-functions">Iteration functions</a></li><li><a href="#core-functions">Core functions</a></li><li><a href="#i/o-functions">I/O functions</a></li><li><a href="#helper-functions">Helper functions</a></li></ul></nav></header><section><header><h6 id="type-definition"><a href="#type-definition" class="anchor"></a>Type definition</h6></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>Type of a text corpus.</p></dd></dl></section><section><header><h6 id="query-corpus"><a href="#query-corpus" class="anchor"></a>Query corpus</h6></header><dl><dt class="spec value" id="val-length"><a href="#val-length" class="anchor"></a><code><span class="keyword">val</span> length : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p>Return the size of the corpus, i.e. number of documents.</p></dd></dl><dl><dt class="spec value" id="val-get"><a href="#val-get" class="anchor"></a><code><span class="keyword">val</span> get : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> string</code></dt><dd><p>Return the ith document in the corpus.</p></dd></dl><dl><dt class="spec value" id="val-get_tok"><a href="#val-get_tok" class="anchor"></a><code><span class="keyword">val</span> get_tok : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int array</span></code></dt><dd><p>Return the ith tokenised document in the corpus.</p></dd></dl><dl><dt class="spec value" id="val-get_uri"><a href="#val-get_uri" class="anchor"></a><code><span class="keyword">val</span> get_uri : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Return the path of the corpus.</p></dd></dl><dl><dt class="spec value" id="val-get_bin_uri"><a href="#val-get_bin_uri" class="anchor"></a><code><span class="keyword">val</span> get_bin_uri : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Return the path of the binary format of corpus.</p></dd></dl><dl><dt class="spec value" id="val-get_bin_fh"><a href="#val-get_bin_fh" class="anchor"></a><code><span class="keyword">val</span> get_bin_fh : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Stdlib.in_channel</code></dt><dd><p>Return the file handle of the binary formation of corpus.</p></dd></dl><dl><dt class="spec value" id="val-get_tok_uri"><a href="#val-get_tok_uri" class="anchor"></a><code><span class="keyword">val</span> get_tok_uri : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Return the path of tokenised corpus.</p></dd></dl><dl><dt class="spec value" id="val-get_tok_fh"><a href="#val-get_tok_fh" class="anchor"></a><code><span class="keyword">val</span> get_tok_fh : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Stdlib.in_channel</code></dt><dd><p>Return the file handle of the tokenised corpus.</p></dd></dl><dl><dt class="spec value" id="val-get_vocab_uri"><a href="#val-get_vocab_uri" class="anchor"></a><code><span class="keyword">val</span> get_vocab_uri : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Return the path of vocabulary file associated with the corpus.</p></dd></dl><dl><dt class="spec value" id="val-get_vocab"><a href="#val-get_vocab" class="anchor"></a><code><span class="keyword">val</span> get_vocab : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Owl_nlp_vocabulary/index.html#type-t">Owl_nlp_vocabulary.t</a></code></dt><dd><p>Return the vocabulary associated with the corpus.</p></dd></dl><dl><dt class="spec value" id="val-get_docid"><a href="#val-get_docid" class="anchor"></a><code><span class="keyword">val</span> get_docid : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>int array</span></code></dt><dd><p>Return a list of document ids which are mapped back to the original file where the corpus is built.</p></dd></dl></section><section><header><h6 id="iteration-functions"><a href="#iteration-functions" class="anchor"></a>Iteration functions</h6></header><dl><dt class="spec value" id="val-next"><a href="#val-next" class="anchor"></a><code><span class="keyword">val</span> next : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Return the next document in the corpus.</p></dd></dl><dl><dt class="spec value" id="val-next_tok"><a href="#val-next_tok" class="anchor"></a><code><span class="keyword">val</span> next_tok : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>int array</span></code></dt><dd><p>Return the next tokenised document in the corpus.</p></dd></dl><dl><dt class="spec value" id="val-iteri"><a href="#val-iteri" class="anchor"></a><code><span class="keyword">val</span> iteri : <span>(int <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Iterate all the documents in the corpus, the index (line number) is passed in.</p></dd></dl><dl><dt class="spec value" id="val-iteri_tok"><a href="#val-iteri_tok" class="anchor"></a><code><span class="keyword">val</span> iteri_tok : <span>(int <span>&#45;&gt;</span> <span>int array</span> <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Iterate the tokenised documents in the corpus, the index (line number) is passed in.</p></dd></dl><dl><dt class="spec value" id="val-mapi"><a href="#val-mapi" class="anchor"></a><code><span class="keyword">val</span> mapi : <span>(int <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> array</span></code></dt><dd><p>Map all the documents in a corpus into another array. The index (line number) is passed in.</p></dd></dl><dl><dt class="spec value" id="val-mapi_tok"><a href="#val-mapi_tok" class="anchor"></a><code><span class="keyword">val</span> mapi_tok : <span>(int <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> array</span></code></dt><dd><p>Map all the tokenised ocuments in a corpus into another array. The index (line number) is passed in.</p></dd></dl><dl><dt class="spec value" id="val-next_batch"><a href="#val-next_batch" class="anchor"></a><code><span class="keyword">val</span> next_batch : <span>?&#8288;size:int</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>string array</span></code></dt><dd><p>Return the next batch of documents in a corpus as a string array. The default ``size`` is 100.</p></dd></dl><dl><dt class="spec value" id="val-next_batch_tok"><a href="#val-next_batch_tok" class="anchor"></a><code><span class="keyword">val</span> next_batch_tok : <span>?&#8288;size:int</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>int array</span> array</span></code></dt><dd><p>Return the next batch of tokenised documents in a corpus as a string array. The default ``size`` is 100.</p></dd></dl><dl><dt class="spec value" id="val-reset_iterators"><a href="#val-reset_iterators" class="anchor"></a><code><span class="keyword">val</span> reset_iterators : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Reset the iterator to the begining of the corpus.</p></dd></dl></section><section><header><h6 id="core-functions"><a href="#core-functions" class="anchor"></a>Core functions</h6></header><dl><dt class="spec value" id="val-build"><a href="#val-build" class="anchor"></a><code><span class="keyword">val</span> build : <span>?&#8288;docid:<span>int array</span></span> <span>&#45;&gt;</span> <span>?&#8288;stopwords:<span><span>(string, <span class="type-var">'a</span>)</span> Stdlib.Hashtbl.t</span></span> <span>&#45;&gt;</span> <span>?&#8288;lo:float</span> <span>&#45;&gt;</span> <span>?&#8288;hi:float</span> <span>&#45;&gt;</span> <span>?&#8288;vocab:<a href="../Owl_nlp_vocabulary/index.html#type-t">Owl_nlp_vocabulary.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;minlen:int</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>This function builds up a corpus of type ``t`` from a given raw text corpus. We assume that each line in the raw text corpus represents a document.</p><p>Parameters: * ``?docid``: passed in ``docid`` can be used for tracking back to the original corpus, but this is not compulsory. * ``?stopwords``: stopwords used in building vocabulary. * ``?lo``: any word below this lower bound of the frequency is removed from vocabulary. * ``?hi``: any word above this upper bound of the frequency is removed from vocabulary. * ``?vocab``: an optional vocabulary, if it is not passed, the vocabulary is built from current corpus. * ``?(minlen=10)``: threshold of the document length, any document shorter than this is removed from the corpus. * ``fname``: the file name of the raw text corpus.</p></dd></dl><dl><dt class="spec value" id="val-tokenise"><a href="#val-tokenise" class="anchor"></a><code><span class="keyword">val</span> tokenise : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>int array</span></code></dt><dd><p>``tokenise corpus doc`` tokenises the document ``doc`` using the ``corpus`` and its associated vocabulary.</p></dd></dl><dl><dt class="spec value" id="val-unique"><a href="#val-unique" class="anchor"></a><code><span class="keyword">val</span> unique : string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>int array</span></code></dt><dd><p>Remove the duplicates in a text corpus, the ids of the removed files are returned.</p></dd></dl><dl><dt class="spec value" id="val-simple_process"><a href="#val-simple_process" class="anchor"></a><code><span class="keyword">val</span> simple_process : string <span>&#45;&gt;</span> string</code></dt><dd><p>Function for simple pre-processing a given string.</p></dd></dl><dl><dt class="spec value" id="val-preprocess"><a href="#val-preprocess" class="anchor"></a><code><span class="keyword">val</span> preprocess : <span>(string <span>&#45;&gt;</span> bytes)</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>``preprocess f input_file output_file`` pre-processes a given file ``input_file`` with the passed in function ``f`` then saves the output to ``output_file``.</p><p>E.g., you can plug in ``simple_process`` function to clean up the text. Note this function will not change the number of lines in a corpus.</p></dd></dl></section><section><header><h6 id="i/o-functions"><a href="#i/o-functions" class="anchor"></a>I/O functions</h6></header><dl><dt class="spec value" id="val-save"><a href="#val-save" class="anchor"></a><code><span class="keyword">val</span> save : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>Serialise the corpus and save it to a file of given name.</p></dd></dl><dl><dt class="spec value" id="val-load"><a href="#val-load" class="anchor"></a><code><span class="keyword">val</span> load : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Load a serialised corpus from a file.</p></dd></dl><dl><dt class="spec value" id="val-save_txt"><a href="#val-save_txt" class="anchor"></a><code><span class="keyword">val</span> save_txt : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>Convert the tokenised corpus back to a text file</p></dd></dl><dl><dt class="spec value" id="val-to_string"><a href="#val-to_string" class="anchor"></a><code><span class="keyword">val</span> to_string : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>The string representation of a corpus, contains the summary of a corpus.</p></dd></dl><dl><dt class="spec value" id="val-print"><a href="#val-print" class="anchor"></a><code><span class="keyword">val</span> print : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Pretty print the summary of a text corpus.</p></dd></dl></section><section><header><h6 id="helper-functions"><a href="#helper-functions" class="anchor"></a>Helper functions</h6></header><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : string <span>&#45;&gt;</span> <span>int array</span> <span>&#45;&gt;</span> <span>int array</span> <span>&#45;&gt;</span> <span>Stdlib.in_channel option</span> <span>&#45;&gt;</span> <span>Stdlib.in_channel option</span> <span>&#45;&gt;</span> <span><a href="../Owl_nlp_vocabulary/index.html#type-t">Owl_nlp_vocabulary.t</a> option</span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span>int array</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>```create uri bin_ofs tok_ofs bin_fh tok_fh vocab minlen docid` wraps up the corpus into a record of type ``t``.</p></dd></dl><dl><dt class="spec value" id="val-reduce_model"><a href="#val-reduce_model" class="anchor"></a><code><span class="keyword">val</span> reduce_model : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Set some fields to ``None`` so it can be safely serialised.</p></dd></dl><dl><dt class="spec value" id="val-cleanup"><a href="#val-cleanup" class="anchor"></a><code><span class="keyword">val</span> cleanup : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Close the opened file handles associated with the corpus.</p></dd></dl></section></div></body></html>